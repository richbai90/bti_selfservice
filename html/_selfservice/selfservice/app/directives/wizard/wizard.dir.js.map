{"version":3,"sources":["../../../../_itsm_default_v2_template/app/directives/wizard/wizard.dir.js"],"names":["angular","module","directive","wizard","$inject","$q","restrict","transclude","scope","currentStage","submit","templateUrl","controller","$scope","getCurrentStage","wizDataServ","wizardStages","goToStageByReference","stage","stageNumber","indexOf","goToStage","isValidStageNumber","length","canGoToStage","newStage","getStageState","stageStatesEnum","disabled","requiredStageNumber","complete","stageForm","$valid","ready","goToNext","hasNext","goToPrevious","hasPrevious","registerStage","stageScope","push","unregisterStage","index","splice","isSubmittable","every","submitting","onSubmitClicked","when","then","$watch","newVal","oldVal","entered"],"mappings":"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","file":"wizard.dir.js","sourcesContent":["(function () {\r\n    'use strict';\r\n    angular\r\n        .module('swSelfService')\r\n        .directive('wizard',wizard);\r\n    wizard.$inject = ['$q'];\r\n    function wizard($q)\r\n    {\r\n      return {\r\n          restrict: \"E\",\r\n          transclude: true,\r\n          scope: {\r\n              currentStage: \"=\",\r\n              submit: \"&\"\r\n          },\r\n          templateUrl: \"templates/wizard/wizard.main.tpl.html\",\r\n          controller: function($scope) {\r\n              $scope.currentStage = $scope.currentStage || 0;\r\n              $scope.getCurrentStage = function() {\r\n                  return $scope.wizDataServ.wizardStages[$scope.currentStage];\r\n              };\r\n              this.getCurrentStage = $scope.getCurrentStage;\r\n              $scope.goToStageByReference = function(stage) {\r\n                  var stageNumber = $scope.wizDataServ.wizardStages.indexOf(stage);\r\n                  return $scope.goToStage(stageNumber);\r\n              };\r\n              var isValidStageNumber = function(stageNumber) {\r\n                  return stageNumber < $scope.wizDataServ.wizardStages.length && stageNumber >= 0;\r\n              };\r\n              $scope.canGoToStage = function(stageNumber) {\r\n                  if (!isValidStageNumber(stageNumber)) {\r\n                      return false;\r\n                  }\r\n                  var newStage = $scope.wizDataServ.wizardStages[stageNumber];\r\n                  return $scope.getStageState(newStage) != $scope.stageStatesEnum.disabled;\r\n              };\r\n              $scope.goToStage = function(stageNumber) {\r\n                  if ($scope.canGoToStage(stageNumber)) {\r\n                      $scope.currentStage = stageNumber;\r\n                      return true;\r\n                  }\r\n                  return false;\r\n              };\r\n              $scope.getStageState = function(stage) {\r\n                  if (stage.requiredStageNumber && isValidStageNumber(stage.requiredStageNumber) && $scope.getStageState($scope.wizDataServ.wizardStages[stage.requiredStageNumber]) != $scope.stageStatesEnum.complete) {\r\n                      return $scope.stageStatesEnum.disabled;\r\n                  } else if (stage.stageForm.$valid) {\r\n                      return $scope.stageStatesEnum.complete;\r\n                  } else return $scope.stageStatesEnum.ready;\r\n              };\r\n              $scope.stageStatesEnum = {\r\n                  disabled: 0,\r\n                  ready: 1,\r\n                  complete: 2\r\n              };\r\n              $scope.goToNext = function() {\r\n                  $scope.goToStage($scope.currentStage + 1);\r\n              };\r\n              $scope.hasNext = function() {\r\n                return $scope.wizDataServ.wizardStages.length > $scope.currentStage + 1 && $scope.getStageState($scope.wizDataServ.wizardStages[$scope.currentStage + 1]) != $scope.stageStatesEnum.disabled;\r\n              };\r\n              $scope.goToPrevious = function() {\r\n                $scope.goToStage($scope.currentStage - 1);\r\n              };\r\n              $scope.hasPrevious = function() {\r\n                return $scope.currentStage > 0;\r\n              };\r\n\r\n              $scope.wizDataServ.wizardStages = [];\r\n              this.registerStage = function(stageScope) {\r\n                $scope.wizDataServ.wizardStages.push(stageScope);\r\n              };\r\n              this.unregisterStage = function(stageScope) {\r\n                var index = $scope.wizDataServ.wizardStages.indexOf(stageScope);\r\n                if (index >= 0) {\r\n                    $scope.wizDataServ.wizardStages.splice(index, 1);\r\n                }\r\n              };\r\n              $scope.isSubmittable = function() {\r\n                  return $scope.wizDataServ.wizardStages.every(function(stage) {\r\n                      return $scope.getStageState(stage) == $scope.stageStatesEnum.complete;\r\n                  });\r\n              };\r\n              $scope.submitting = false;\r\n              $scope.onSubmitClicked = function() {\r\n                  $scope.submitting = true;\r\n                  $q.when($scope.submit()).then(function() {\r\n                      $scope.submitting = false;\r\n                  });\r\n              };\r\n              $scope.$watch(\"currentStage\", function(newVal, oldVal) {\r\n                  if (newVal != oldVal) {\r\n                      if (!$scope.canGoToStage(newVal)) {\r\n                          if (oldVal && $scope.canGoToStage(oldVal)) {\r\n                              $scope.currentStage = oldVal;\r\n                          } else $scope.currentStage = 0;\r\n                      } else {\r\n                          $scope.getCurrentStage().entered();\r\n                      }\r\n                  }\r\n              });\r\n              $scope.$watch(\"stages.length\", function() {\r\n                  if (!$scope.getCurrentStage()) {\r\n                      $scope.currentStage = 0;\r\n                  }\r\n              }, true);\r\n          }\r\n      };\r\n    }\r\n})();\r\n"]}