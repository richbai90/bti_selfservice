{"version":3,"sources":["../../../_itsm_default_v2_template/app/controllers/profile.ctrl.js"],"names":["angular","module","controller","ProfileDetailsCtrl","$inject","$scope","SWSessionService","ProfileService","profile","resetProfileDetails","checkActiveSession","then","getProfileDetails","user","submitProfileUpdate","updateProfileDetails","$on","ProfileCICtrl","getCustCIs","cis","cisArray","ProfileKBCtrl","wssLogging","resetCustSubs","getKBSubsCatIDs","kbnotifs","getKBCatalogs","kbcats","kbCatArray","i","length","indexOf","catalogid","push","id","name","catalogname","subscribed","submitSubsUpdate","updateCustSubs"],"mappings":"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","file":"profile.ctrl.js","sourcesContent":["(function () {\r\n    'use strict';\r\n\r\n    angular\r\n        .module('swSelfService')\r\n        .controller('ProfileDetailsCtrl', ProfileDetailsCtrl);\r\n    ProfileDetailsCtrl.$inject = ['$scope','SWSessionService','ProfileService'];\r\n    function ProfileDetailsCtrl($scope, SWSessionService, ProfileService)\r\n    {\r\n\t\t$scope.profile = ProfileService;\r\n\r\n\t\t$scope.resetProfileDetails = function()\r\n\t\t{\r\n\t\t\tSWSessionService.checkActiveSession().then(function()\r\n\t\t\t{\t\r\n\t\t\t\t$scope.profile.getProfileDetails().then(function(user)\r\n\t\t\t\t{\r\n\t\t\t\t\t$scope.user = user;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t$scope.submitProfileUpdate = function()\r\n\t\t{\r\n\t\t\tSWSessionService.checkActiveSession().then(function()\r\n\t\t\t{\r\n\t\t\t\t$scope.profile.updateProfileDetails($scope.user);\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t$scope.resetProfileDetails();\r\n\r\n\t\t//Watch for logout broadcast to clean up session-specific data ready for a new user\r\n\t\t$scope.$on('logout',function()\r\n\t\t{\r\n\t\t\t$scope.profile = {};\r\n\t\t});\r\n    }\r\n\t\r\n\t\r\n\tangular\r\n        .module('swSelfService')\r\n        .controller('ProfileCICtrl', ProfileCICtrl);\r\n    ProfileCICtrl.$inject = ['$scope','SWSessionService','ProfileService'];\r\n    function ProfileCICtrl($scope, SWSessionService, ProfileService)\r\n    {\r\n\t\t$scope.profile = ProfileService;\r\n\r\n\t\tSWSessionService.checkActiveSession().then(function()\r\n\t\t{\r\n\t\t\t$scope.profile.getCustCIs().then(function(cis)\r\n\t\t\t{\r\n\t\t\t\t $scope.cisArray = cis;\r\n\t\t\t});\r\n\t\t});\r\n\t\t//Watch for logout broadcast to clean up session-specific data ready for a new user\r\n\t\t$scope.$on('logout',function()\r\n\t\t{\r\n\t\t\t$scope.profile = {};\r\n\t\t});\r\n\t}\r\n\t\r\n\tangular\r\n        .module('swSelfService')\r\n        .controller('ProfileKBCtrl', ProfileKBCtrl);\r\n    ProfileKBCtrl.$inject = ['$scope','SWSessionService','ProfileService','wssLogging'];\r\n    function ProfileKBCtrl($scope, SWSessionService, ProfileService, wssLogging)\r\n    {\r\n\t\t$scope.profile = ProfileService;\r\n\r\n\t\tSWSessionService.checkActiveSession().then(function()\r\n\t\t{\r\n\t\t\t$scope.resetCustSubs();\r\n\t\t});\r\n\t\t\r\n\t\t$scope.resetCustSubs = function()\r\n\t\t{\r\n\t\t\t//-- get customer subscribed catalogs\r\n\t\t\t$scope.profile.getKBSubsCatIDs().then(function(kbnotifs)\r\n\t\t\t{\r\n\t\t\t\t//-- get all catalogs\r\n\t\t\t\t$scope.profile.getKBCatalogs().then(function(kbcats)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar kbCatArray = [];\r\n\t\t\t\t\t//-- for each catalog...\r\n\t\t\t\t\tfor (var i = 0; i < kbcats.length; i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t//-- if cutomer is subscribed to catalog...\r\n\t\t\t\t\t\tif(kbnotifs.indexOf(kbcats[i].catalogid) > -1)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tkbCatArray.push({id: kbcats[i].catalogid,\r\n\t\t\t\t\t\t\t\t\t\t\t name: kbcats[i].catalogname,\r\n\t\t\t\t\t\t\t\t\t\t\t subscribed: true});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//-- if cutomer is NOT subscribed to catalog...\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tkbCatArray.push({id: kbcats[i].catalogid,\r\n\t\t\t\t\t\t\t\t\t\t\t name: kbcats[i].catalogname,\r\n\t\t\t\t\t\t\t\t\t\t\t subscribed: false});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$scope.kbCatArray = kbCatArray;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t$scope.submitSubsUpdate = function()\r\n\t\t{\r\n\t\t\t$scope.profile.updateCustSubs($scope.kbCatArray);\r\n\t\t}\r\n\r\n\t\t//Watch for logout broadcast to clean up session-specific data ready for a new user\r\n\t\t$scope.$on('logout',function()\r\n\t\t{\r\n\t\t\t$scope.profile = {};\r\n\t\t});\r\n\t}\r\n\t\r\n})();\r\n"]}