{"version":3,"sources":["../../../_itsm_default_v2_template/app/controllers/global.search.ctrl.js"],"names":["angular","module","controller","GlobalSearchCtrl","$inject","$scope","SWSessionService","KnowledgeService","ProfileService","ServicesService","RequestListService","$state","GlobalSearchService","searchService","knowledge","profile","custServices","custRequests","globalSearchString","kbResults","searchingKB","kbSearchCriteria","searchType","maxResults","searchOptions","title","keywords","problem","solution","catalog","doSearch","checkActiveSession","then","go","doKBSearch","doServiceSearch","doRequestSearch","searchString","searchKB","kbArticleArray","knowledgeResults","listType","search","getPagedServices","requestPage","callStatus","pageNo","getPagedRequests","$on"],"mappings":"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","file":"global.search.ctrl.js","sourcesContent":["(function () {\r\n    'use strict';\r\n\r\n\tangular\r\n        .module('swSelfService')\r\n        .controller('GlobalSearchCtrl', GlobalSearchCtrl);\r\n  GlobalSearchCtrl.$inject = ['$scope','SWSessionService','KnowledgeService', 'ProfileService','ServicesService','RequestListService','$state','GlobalSearchService'];\r\n  function GlobalSearchCtrl($scope, SWSessionService, KnowledgeService, ProfileService, ServicesService, RequestListService, $state, GlobalSearchService)\r\n  {\r\n    $scope.searchService = GlobalSearchService;\r\n\t\t$scope.knowledge = KnowledgeService;\r\n    $scope.profile = ProfileService;\r\n    $scope.custServices = ServicesService;\r\n    $scope.custRequests = RequestListService;\r\n\r\n    $scope.globalSearchString = \"\";\r\n    $scope.searchService.kbResults = [];\r\n\r\n    //KB Search Params Setup\r\n    $scope.searchService.searchingKB = false;\r\n    $scope.kbSearchCriteria = {};\r\n    $scope.kbSearchCriteria.searchType = 2;\r\n    $scope.kbSearchCriteria.maxResults = 100;\r\n    $scope.kbSearchCriteria.searchOptions = [];\r\n    $scope.kbSearchCriteria.searchOptions.title = true;\r\n    $scope.kbSearchCriteria.searchOptions.keywords = true;\r\n    $scope.kbSearchCriteria.searchOptions.problem = true;\r\n    $scope.kbSearchCriteria.searchOptions.solution = true;\r\n    $scope.kbSearchCriteria.searchOptions.catalog = \"\";\r\n\r\n    $scope.doSearch = function() {\r\n      SWSessionService.checkActiveSession().then(function(){\r\n        //Switch to global search state\r\n        $state.go(\"globalsearch\");\r\n\r\n        //Do KB Search First\r\n        $scope.doKBSearch();\r\n        //Now do Service Search\r\n        $scope.doServiceSearch();\r\n        //Now do Request Search\r\n        $scope.doRequestSearch();\r\n      });\r\n    };\r\n\r\n    $scope.doKBSearch = function () {\r\n      $scope.searchService.searchingKB = true;\r\n      $scope.kbSearchCriteria.searchString = $scope.searchService.globalSearchString;\r\n      $scope.knowledge.searchKB($scope.kbSearchCriteria, false).then(function(kbArticleArray)\r\n      {\r\n        $scope.searchService.knowledgeResults = kbArticleArray;\r\n        $scope.searchService.searchingKB = false;\r\n      });\r\n    };\r\n\r\n    $scope.doServiceSearch = function() {\r\n      $scope.custServices.listType = 'cust';\r\n      $scope.custServices.search = GlobalSearchService.globalSearchString;\r\n      $scope.custServices.getPagedServices();\r\n    };\r\n\r\n    $scope.doRequestSearch = function() {\r\n      $scope.custRequests.requestPage = 'cust';\r\n      $scope.custRequests.callStatus = 'all';\r\n      $scope.custRequests.search = GlobalSearchService.globalSearchString;\r\n      $scope.custRequests.pageNo = 1;\r\n      $scope.custRequests.getPagedRequests();\r\n    };\r\n\r\n\r\n\t\t//Watch for logout broadcast to clean up session-specific data ready for a new user\r\n\t\t$scope.$on('logout',function()\r\n\t\t{\r\n\t\t\t$scope.knowledge = {};\r\n\t\t});\r\n\t}\r\n\r\n\r\n})();\r\n"]}