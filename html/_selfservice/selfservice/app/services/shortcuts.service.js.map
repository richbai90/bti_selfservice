{"version":3,"sources":["../../../_itsm_default_v2_template/app/services/shortcuts.service.js"],"names":["sw","factory","defaultShortcuts","prepShortcuts","orderBy","wssLayout","homePage","shortcuts","merge","shortcutKeys","Object","keys","filter","s","hidden","evalCondition","condition","sort","a","b","row","isObject","item","Array","isArray","target","sources","length","source","shift","key","hasOwnProperty","assign","map","reorderd","forEach","e","valInScope","v","$scope","vParts","split","trim","$eval","evalShortcut","sc","valInObject","entries","cond","initShortcuts","reduce","acc","cv","shortcut","push","initFlatShortcuts","angular","module"],"mappings":"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","file":"shortcuts.service.js","sourcesContent":["((sw) => {\n  'use strict';\n  sw.factory('shortcuts', () => {\n\n    const defaultShortcuts = {\n      \"_support\": {\n        \"ngClick\": '$scope | raiseSupportRequest',\n        \"icon\": \"fa-life-ring\",\n        \"text\": \"Support Me\",\n        \"desc\": \"Raise a new support request\",\n        \"condition\": \"canRaiseRequest\"\n      },\n      \"_services\": {\n        \"sref\": \"services\",\n        \"icon\": \"fa-cogs\",\n        \"text\": \"Services\",\n        \"desc\": \"Request or view a service\",\n      },\n      \"_requests\": {\n        \"sref\": \"requests.myrequests\",\n        \"icon\": \"fa-tasks\",\n        \"text\": \"Requests\",\n        \"desc\": \"View or update your requests\",\n      },\n      \"_knowledge\": {\n        \"sref\": \"knowledge\",\n        \"icon\": \"fa-binoculars\",\n        \"text\": \"Knowledge\",\n        \"desc\": \"Search for help\",\n      },\n      \"_authorize\": {\n        \"sref\": \"requestsauth.myauths\",\n        \"icon\": \"fa-check-square-o\",\n        \"badge\": \"numAuths\",\n        \"text\": \"Authorize\",\n        \"desc\": \"Authorize a request\",\n        \"condition\": \"$scope | sessServ.numAuths > 0\"\n      },\n    };\n\n    const prepShortcuts = () => {\n      return orderBy(wssLayout.homePage.shortcuts, merge({}, defaultShortcuts, wssLayout.homePage.shortcuts));\n    };\n    \n    const shortcutKeys = shortcuts => {\n      let shortcutKeys = Object.keys(shortcuts).filter(s => (!shortcuts[s].hidden && evalCondition(shortcuts[s].condition)));\n      shortcutKeys.sort((a, b) => ((shortcuts[a].row || 0) - (shortcuts[b].row || 0)));\n      return shortcutKeys;\n    };\n    const isObject = item => {\n      return (item && typeof item === 'object' && !Array.isArray(item));\n    };\n\n    const merge = (target, ...sources) => {\n      if (!sources.length) return target;\n      const source = sources.shift();\n\n      if (isObject(target) && isObject(source)) {\n        for (const key in source) {\n          if (source.hasOwnProperty(key)) {\n            if (isObject(source[key])) {\n              if (!target[key]) Object.assign(target, { [key]: {} });\n              merge(target[key], source[key]);\n            } else {\n              Object.assign(target, { [key]: source[key] });\n            }\n          }\n        }\n      }\n\n      return merge(target, ...sources);\n    };\n\n    const orderBy = (map, target) => {\n      map = (Array.isArray(map) && map) || Object.keys(map);\n      let reorderd = {};\n      map.forEach(e => {\n        reorderd[e] = target[e];\n      });\n      return merge({}, reorderd);\n    };\n\n    const valInScope = (v, $scope) => {\n      if (!v) return v;\n      let vParts = v.split('|');\n      if (vParts[0].trim() !== '$scope') return false;\n      return $scope.$eval(vParts[1].trim());\n    };\n\n    const evalShortcut = (sc, $scope) => {\n      let valInObject = v => {\n        return ((sc, v) => {\n          return sc[v];\n        })(sc, v)\n      };\n      for (let e of Object.entries(sc)) {\n        sc[e[0]] = valInObject(e[1]) || valInScope(e[1], $scope) || e[1]\n      }\n    };\n    const evalCondition = cond => typeof cond === 'undefined' || cond;\n    const initShortcuts = $scope => {\n      let shortcuts = prepShortcuts();\n      shortcuts = shortcutKeys(shortcuts).reduce(\n        (acc, cv) => {\n          let shortcut = shortcuts[cv];\n          evalShortcut(shortcut, $scope);\n          let row = acc[(shortcuts[cv].row || 1) - 1];\n          if (!Array.isArray(row)) {\n            row = [];\n            acc.push(row);\n          }\n\n          row.push(shortcut);\n          return acc;\n        }\n        , []\n      );\n\n      return shortcuts;\n\n    };\n    const initFlatShortcuts = $scope => {\n      let shortcuts = prepShortcuts();\n      shortcuts = shortcutKeys(shortcuts).map(\n        (key) => {\n          let shortcut = shortcuts[key];\n          evalShortcut(shortcut, $scope);\n          return shortcut\n        });\n\n      return shortcuts;\n\n    };\n\n    return {\n      isObject,\n      valInScope,\n      evalShortcut,\n      evalCondition,\n      initShortcuts,\n      initFlatShortcuts\n    }\n\n  })\n})(angular.module('swSelfService'));"]}