{"version":3,"sources":["../../../_itsm_default_v2_template/app/services/request.details.service.js"],"names":["angular","module","service","RequestDetailsService","$inject","$q","XMLMCService","toaster","wssHelpers","store","$http","wssLogging","self","getAssetsTableStructure","deferred","defer","assetSQLColumns","getTableConfig","assetConfig","then","response","assetConfigObject","outputSQLColumns","assetOrderBy","outputOrderBy","resolve","error","logger","reject","promise","getRequestDetails","callref","custDetails","get","callrefValue","sqparams","keysearch","xmlmc","MethodCall","addParam","invoke","onSuccess","params","rowData","row","requestDetails","onFailure","getRequestDiary","requestDiary","Object","prototype","toString","call","intArrayLength","length","i","push","getRequestAttachments","requestAttachments","getRequestAssets","requestAssets","strAddTables","processAdditionalTables","table","recordsStoredQuery","getRequestComponents","requestComponents","buildProgressionBars","progression","progressData","progressBarData","progressTimelineData","progressMessages","progType","progIcon","badgeTooltip","intCurrentProgress","useProgress","barProgress","barSeperatorSize","completeDescription","workingDescription","failureDescription","bpm_progress","forEach","progVal","progKey","bpm_progress_fail","pk_progid","isDefined","message_failure","parseInt","percentage","value","type","percent","title","badgeClass","badgeIconClass","content","description","message_complete","message_working","message","getWorkflowProgression","workflowProgression","bpm_workflow_id","getBPMExtendedTableData","extendedData","workflow","record","ext_db_table","extendedRecord","meta","recordVal","recordKey","extDisplayName","metaVal","metaKey","displayName","recordValue","res","match","isArray","getCallAttachment","filename","dataid","downloadingAttachment","oFile","split","strMimeType","oFileContent","decodeBase64","file","Blob","fileURL","URL","createObjectURL","a","document","createElement","href","target","download","body","appendChild","click","isRequestAuth","instanceConfig","rowArray","requestAuthorisation","managerid","fk_manager","getRequestAuthComponents","authStandardComponents","authOptionalComponents","authUpgradeComponents","authComponentStrings","itsm_fk_service","compResponse","flg_isoptional","upgradeCompResponse","aCompVal","aCompKey","qty","overqty","override","price_diff","comp_price","getFileIcon","fileName","fileExtension","slice","lastIndexOf"],"mappings":"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","file":"request.details.service.js","sourcesContent":["(function (){\r\n    'use strict';\r\n    angular\r\n      .module('swSelfService')\r\n      .service('RequestDetailsService', RequestDetailsService);\r\n\r\n    RequestDetailsService.$inject=['$q','XMLMCService','toaster','wssHelpers','store','$http','wssLogging'];\r\n    function RequestDetailsService($q, XMLMCService, toaster , wssHelpers, store, $http, wssLogging) {\r\n      var self = {\r\n        'assetConfig': 'table.request.assets',\r\n        'assetSQLColumns': '',\r\n        'callref': 0,\r\n        'requestDetails': [],\r\n        'requestDiary': [],\r\n        'requestAssets': [],\r\n        'requestAttachments': [],\r\n        'requestComponents': [],\r\n        'requestAuthorisation': [],\r\n        'callClass': ''\r\n      };\r\n\r\n\r\n      self.getAssetsTableStructure = function() {\r\n        var deferred = $q.defer();\r\n        self.assetSQLColumns = '';\r\n        wssHelpers.getTableConfig(self.assetConfig).then(function(response){\r\n          self.assetConfigObject = response;\r\n          self.assetSQLColumns = response.outputSQLColumns;\r\n          self.assetOrderBy = response.outputOrderBy;\r\n          deferred.resolve(response);\r\n        }, function(error){\r\n          wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getAssetsTableStructure\", false, false);\r\n          deferred.reject(error);\r\n        });\r\n        return deferred.promise;\r\n      };\r\n\r\n      self.getRequestDetails = function(callref){\r\n        self.custDetails = store.get('custDetails');\r\n        self.callref = wssHelpers.callrefValue(callref);\r\n        var deferred = $q.defer();\r\n        var sqparams = \"custid=\"+self.custDetails.keysearch;\r\n        sqparams += \"&callref=\"+self.callref;\r\n        var xmlmc = new XMLMCService.MethodCall();\r\n        xmlmc.addParam(\"storedQuery\", \"query/wss/requests/request.details\");\r\n        xmlmc.addParam(\"parameters\", sqparams);\r\n        xmlmc.invoke(\"data\", \"invokeStoredQuery\", {\r\n          onSuccess: function(params){\r\n            if(params.rowData.row){\r\n              self.requestDetails = params.rowData.row;\r\n              deferred.resolve(self.requestDetails);\r\n            } else {\r\n              deferred.reject(params);\r\n            }\r\n          },\r\n          onFailure: function(error){\r\n            wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getRequestDetails\", false, false);\r\n            deferred.reject(error);\r\n          }\r\n        });\r\n        return deferred.promise;\r\n      };\r\n\r\n      self.getRequestDiary = function(callref){\r\n        self.requestDiary = [];\r\n        self.callref = wssHelpers.callrefValue(callref);\r\n        var deferred = $q.defer();\r\n        var sqparams = \"custid=\"+self.custDetails.keysearch;\r\n        sqparams += \"&callref=\"+self.callref;\r\n        var xmlmc = new XMLMCService.MethodCall();\r\n        xmlmc.addParam(\"storedQuery\", \"query/wss/requests/request.diary\");\r\n        xmlmc.addParam(\"parameters\", sqparams);\r\n        xmlmc.invoke(\"data\", \"invokeStoredQuery\", {\r\n          onSuccess: function(params){\r\n            if(params.rowData) {\r\n              if( Object.prototype.toString.call( params.rowData.row ) === '[object Array]' ) {\r\n                var intArrayLength = params.rowData.row.length;\r\n                //obj is array\r\n                for (var i = 0; i < intArrayLength; i++) {\r\n                  self.requestDiary.push(params.rowData.row[i]);\r\n                }\r\n              } else {\r\n                self.requestDiary.push(params.rowData.row);\r\n              }\r\n              deferred.resolve(self.requestDiary);\r\n            } else {\r\n              deferred.reject(params);\r\n            }\r\n          },\r\n          onFailure: function(error){\r\n            wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getRequestDiary\", false, false);\r\n            //Send a toaster and change state back to Home\r\n            deferred.reject(error);\r\n          }\r\n        });\r\n        return deferred.promise;\r\n      };\r\n\r\n      self.getRequestAttachments = function(callref){\r\n        self.requestAttachments = [];\r\n        self.callref = wssHelpers.callrefValue(callref);\r\n        var deferred = $q.defer();\r\n        var sqparams = \"custid=\"+self.custDetails.keysearch;\r\n        sqparams += \"&callref=\"+self.callref;\r\n        var xmlmc = new XMLMCService.MethodCall();\r\n        xmlmc.addParam(\"storedQuery\", \"query/wss/requests/request.attachments\");\r\n        xmlmc.addParam(\"parameters\", sqparams);\r\n        xmlmc.invoke(\"data\", \"invokeStoredQuery\", {\r\n          onSuccess: function(params){\r\n            if(params.rowData) {\r\n              if( Object.prototype.toString.call( params.rowData.row ) === '[object Array]' ) {\r\n                var intArrayLength = params.rowData.row.length;\r\n                //obj is array\r\n                for (var i = 0; i < intArrayLength; i++) {\r\n                  self.requestAttachments.push(params.rowData.row[i]);\r\n                }\r\n              } else {\r\n                self.requestAttachments.push(params.rowData.row);\r\n              }\r\n              deferred.resolve(self.requestAttachments);\r\n            } else {\r\n              deferred.resolve({});\r\n            }\r\n          },\r\n          onFailure: function(error){\r\n            wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getRequestAttachments\", false, false);\r\n            deferred.reject(error);\r\n          }\r\n        });\r\n        return deferred.promise;\r\n      };\r\n\r\n      self.getRequestAssets = function(callref){\r\n        self.requestAssets = [];\r\n        self.callref = wssHelpers.callrefValue(callref);\r\n        self.strAddTables = wssHelpers.processAdditionalTables(self.assetConfigObject);\r\n        var deferred = $q.defer();\r\n        var sqparams = \"callref=\"+self.callref;\r\n        sqparams += \"&table=\"+self.assetConfigObject.table;\r\n        sqparams += \"&columns=\"+self.assetSQLColumns;\r\n        sqparams += \"&orderby=\"+self.assetOrderBy;\r\n        sqparams += \"&addtables=\"+self.strAddTables;\r\n        var xmlmc = new XMLMCService.MethodCall();\r\n        xmlmc.addParam(\"storedQuery\", self.assetConfigObject.recordsStoredQuery);\r\n        xmlmc.addParam(\"parameters\", sqparams);\r\n        xmlmc.invoke(\"data\", \"invokeStoredQuery\", {\r\n          onSuccess: function(params){\r\n            if(params.rowData) {\r\n              if( Object.prototype.toString.call( params.rowData.row ) === '[object Array]' ) {\r\n                var intArrayLength = params.rowData.row.length;\r\n                //obj is array\r\n                for (var i = 0; i < intArrayLength; i++) {\r\n                  self.requestAssets.push(params.rowData.row[i]);\r\n                }\r\n              } else {\r\n                self.requestAssets.push(params.rowData.row);\r\n              }\r\n              deferred.resolve(self.requestAssets);\r\n            } else {\r\n              deferred.resolve([]);\r\n            }\r\n          },\r\n          onFailure: function(error){\r\n            wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getRequestAssets\", false, false);\r\n            deferred.reject(error);\r\n          }\r\n        });\r\n\r\n        return deferred.promise;\r\n      };\r\n\r\n      self.getRequestComponents = function(callref){\r\n        self.requestComponents = [];\r\n        self.callref = wssHelpers.callrefValue(callref);\r\n        var deferred = $q.defer();\r\n        var sqparams = \"callref=\"+self.callref;\r\n        sqparams += \"&custid=\"+self.custDetails.keysearch;\r\n        var xmlmc = new XMLMCService.MethodCall();\r\n        xmlmc.addParam(\"storedQuery\", \"query/wss/requests/request.components\");\r\n        xmlmc.addParam(\"parameters\", sqparams);\r\n        xmlmc.invoke(\"data\", \"invokeStoredQuery\", {\r\n          onSuccess: function(params){\r\n            if(params.rowData) {\r\n              if( Object.prototype.toString.call( params.rowData.row ) === '[object Array]' ) {\r\n                var intArrayLength = params.rowData.row.length;\r\n                //obj is array\r\n                for (var i = 0; i < intArrayLength; i++) {\r\n                  self.requestComponents.push(params.rowData.row[i]);\r\n                }\r\n              } else {\r\n                self.requestComponents.push(params.rowData.row);\r\n              }\r\n              deferred.resolve(self.requestComponents);\r\n            } else {\r\n              deferred.resolve({});\r\n            }\r\n          },\r\n          onFailure: function(error){\r\n            wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getRequestComponents\", false, false);\r\n            deferred.reject(error);\r\n          }\r\n        });\r\n        return deferred.promise;\r\n      };\r\n\r\n      self.buildProgressionBars = function(progression) {\r\n        //Takes progression records for current workflow\r\n        //and builds/returns stacked bar data for ui-bootstrap progress bar\r\n        var progressData = [];\r\n        progressData.progressBarData = [];\r\n        progressData.progressTimelineData = [];\r\n        progressData.progressMessages = [];\r\n        var progType = 'warning';\r\n        var progIcon = 'fa fa-lg fa-clock-o';\r\n        var badgeTooltip = 'This stage is in progress.';\r\n        var intCurrentProgress = 0;\r\n        var useProgress = 0;\r\n        var barProgress = 0;\r\n        var barSeperatorSize = 2;\r\n        var completeDescription = \"\";\r\n        var workingDescription = \"\";\r\n        var failureDescription = \"\";\r\n        if(self.requestDetails.bpm_progress > 0) {\r\n          progType = 'success';\r\n          progIcon = 'fa fa-lg fa-check';\r\n          badgeTooltip = 'This stage was completed successfully.';\r\n        }\r\n        angular.forEach(progression, function(progVal, progKey){\r\n          if(self.requestDetails.bpm_progress_fail === '1'){\r\n            if(self.requestDetails.bpm_progress ===  progVal.pk_progid){\r\n              progType = 'danger';\r\n              progIcon = 'fa fa-lg fa-ban';\r\n              badgeTooltip = 'This stage has failed progression. See Diary for more information.';\r\n              completeDescription = '';\r\n              workingDescription  = '';\r\n              failureDescription  = '';\r\n              if(angular.isDefined(progVal.message_failure)){\r\n                failureDescription  = progVal.message_failure;\r\n              }\r\n            } else if (progType === 'danger'){\r\n              progType  = 'info';\r\n              progIcon = 'fa fa-lg fa-info';\r\n              badgeTooltip = 'This stage has not been reached yet.';\r\n            }\r\n          }\r\n          barProgress = ((parseInt(progVal.percentage, 10) * 10) - (intCurrentProgress * 10));\r\n          useProgress = parseInt(progVal.percentage, 10) - intCurrentProgress;\r\n          intCurrentProgress = progVal.percentage;\r\n          progressData.progressBarData.push({\r\n            value: barProgress,\r\n            type: progType,\r\n            percent: useProgress,\r\n            title: progVal.title,\r\n            badgeClass: progType,\r\n            badgeIconClass: progIcon,\r\n            content: progVal.description,\r\n            badgeTooltip: badgeTooltip\r\n          });\r\n\r\n          if(self.requestDetails.bpm_progress_fail !== '1'){\r\n            if(self.requestDetails.bpm_progress ===  progVal.pk_progid){\r\n              progType = 'warning';\r\n              progIcon = 'fa fa-lg fa-clock-o';\r\n              badgeTooltip = 'This stage is in progress.';\r\n              if(angular.isDefined(progVal.message_complete)){\r\n                completeDescription = progVal.message_complete;\r\n              } else {\r\n                completeDescription = \"\";\r\n              }\r\n            } else if(progType == 'warning') {\r\n              progType = 'info';\r\n              progIcon = 'fa fa-lg fa-info';\r\n              badgeTooltip = 'This stage has not been reached yet.';\r\n              if(angular.isDefined(progVal.message_working)){\r\n                workingDescription = progVal.message_working;\r\n              } else {\r\n                workingDescription = \"\";\r\n              }\r\n            }\r\n          }\r\n        });\r\n        progressData.progressMessages.push({\r\n          type: 'complete',\r\n          message: completeDescription});\r\n        progressData.progressMessages.push({\r\n          type: 'working',\r\n          message: workingDescription});\r\n        progressData.progressMessages.push({\r\n          type: 'failure',\r\n          message: failureDescription});\r\n        return progressData;\r\n      };\r\n\r\n      self.getWorkflowProgression = function(){\r\n        var workflowProgression = [];\r\n        var deferred = $q.defer();\r\n        if(!angular.isDefined(self.requestDetails.bpm_workflow_id)){\r\n          //No workflow, return empty array\r\n          deferred.resolve(workflowProgression);\r\n        } else {\r\n          //Get workflow progression stages, return as appropriate\r\n          var sqparams = \"workflow=\"+self.requestDetails.bpm_workflow_id;\r\n          var xmlmc = new XMLMCService.MethodCall();\r\n          xmlmc.addParam(\"storedQuery\", \"query/wss/requests/bpm.progress\");\r\n          xmlmc.addParam(\"parameters\", sqparams);\r\n          xmlmc.invoke(\"data\", \"invokeStoredQuery\", {\r\n            onSuccess: function(params){\r\n              if(params.rowData) {\r\n                if( Object.prototype.toString.call( params.rowData.row ) === '[object Array]' ) {\r\n                  var intArrayLength = params.rowData.row.length;\r\n                  //obj is array\r\n                  for (var i = 0; i < intArrayLength; i++) {\r\n                    workflowProgression.push(params.rowData.row[i]);\r\n                  }\r\n                } else {\r\n                  workflowProgression.push(params.rowData.row);\r\n                }\r\n              }\r\n              deferred.resolve(workflowProgression);\r\n            },\r\n            onFailure: function(error){\r\n              wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getWorkflowProgression\", false, false);\r\n              deferred.reject(error);\r\n            }\r\n          });\r\n        }\r\n        return deferred.promise;\r\n      };\r\n\r\n      self.getBPMExtendedTableData = function(){\n        self.extendedData = [];\r\n        if(!angular.isDefined(self.requestDetails.bpm_workflow_id) ||\r\n            self.requestDetails.bpm_workflow_id === \"\"){\r\n          return self.extendedData;\r\n        }\r\n        var xmlmc = new XMLMCService.MethodCall();\r\n        xmlmc.addParam(\"table\", \"bpm_workflow\");\r\n        xmlmc.addParam(\"keyValue\", self.requestDetails.bpm_workflow_id);\r\n        xmlmc.invoke(\"data\", \"getRecord\", {\r\n          onSuccess: function(workflow){\r\n            if( angular.isDefined(workflow.record) &&\n                angular.isDefined(workflow.record.ext_db_table) &&\n                workflow.record.ext_db_table !== ''){\n              //have extended table, now get record from it\n              var xmlmc = new XMLMCService.MethodCall();\n              xmlmc.addParam(\"table\", workflow.record.ext_db_table);\n              xmlmc.addParam(\"keyValue\", self.callref);\n              xmlmc.addParam(\"formatValues\", \"true\");\n              xmlmc.addParam(\"returnMeta\", \"true\");\n              xmlmc.invoke(\"data\", \"getRecord\", {\n                onSuccess: function(extendedRecord){\n                  if( angular.isDefined(extendedRecord.record) &&\n                      angular.isDefined(extendedRecord.meta)){\n                    angular.forEach(extendedRecord.record, function(recordVal, recordKey){\n                      if(recordKey !== \"opencall\"){\n                        var extDisplayName = recordKey;\n                        if(angular.isDefined(extendedRecord.meta[recordKey])){\n                          angular.forEach(extendedRecord.meta[recordKey], function(metaVal, metaKey){\n                            if(metaKey === \"@displayName\"){\n                              extDisplayName = metaVal;\n                            }\n                          });\n                        }\n                        self.extendedData.push({\n                          displayName: extDisplayName,\n                          recordValue: recordVal\n                        });\n                      }\n                    });\n                  }\n                },\n                onFailure: function(error){\n                  //Extended record not found, or error in XMLMC\n                  //error to log ONLY if we have an actual error - ignore \"record not found\" as there may not be an extended table record!\n                  var res = error.match(/^(?=.*\\bThe specified record\\b)(?=.*\\bin table\\b)(?=.*\\bwas not found\\b).*$/);\n                  if(!angular.isArray(res)){\n                    wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getBPMExtendedTableData\", false, false);\n                  }\n                }\n              });\n            }\n          },\r\n          onFailure: function(error){\r\n            wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getBPMExtendedTableData\", false, false);\r\n          }\r\n        });\n        return self.extendedData;\r\n      };\r\n\r\n      self.getCallAttachment = function(callref, filename, dataid){\r\n        self.downloadingAttachment = dataid;\r\n        var sqparams = \"custid=\"+self.custDetails.keysearch;\r\n        sqparams += \"&callref=\"+callref;\r\n        sqparams += \"&filename=\"+filename;\r\n        sqparams += \"&dataid=\"+dataid;\r\n        var xmlmc = new XMLMCService.MethodCall();\r\n        xmlmc.addParam(\"storedQuery\", \"query/wss/requests/request.attachments.get\");\r\n        xmlmc.addParam(\"parameters\", sqparams);\r\n        xmlmc.invoke(\"data\", \"invokeStoredQuery\", {\r\n          onSuccess: function(params){\r\n            if(params.rowData.row.response) {\r\n              var oFile = params.rowData.row.response.split(\"||\");\r\n              var strMimeType = oFile[0];\r\n              var oFileContent = oFile[1];\r\n              wssHelpers.decodeBase64(oFileContent).then(function(response){\r\n                var file = new Blob([ response ], { type : strMimeType });\r\n                //trick to download store a file having its URL\r\n                var fileURL = URL.createObjectURL(file);\r\n                var a         = document.createElement('a');\r\n                a.href        = fileURL;\r\n                a.target      = '_blank';\r\n                a.download    = filename;\r\n                document.body.appendChild(a);\r\n                a.click();\r\n                self.downloadingAttachment = 0;\r\n              });\r\n            } else {\r\n              self.downloadingAttachment = 0;\r\n            }\r\n          },\r\n          onFailure: function(error){\r\n            wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getCallAttachment\", false, false);\r\n            self.downloadingAttachment = 0;\r\n          }\r\n        });\r\n      };\r\n\r\n      self.isRequestAuth = function(){\r\n        self.custDetails = store.get('custDetails');\r\n        self.instanceConfig =store.get(\"instanceConfig\");\r\n        var deferred = $q.defer();\r\n        var sqparams = \"custid=\"+self.custDetails.keysearch;\r\n        sqparams += \"&callref=\"+self.callref;\r\n        var xmlmc = new XMLMCService.MethodCall();\r\n        xmlmc.addParam(\"storedQuery\", \"query/wss/authorisations/request.auth.allowed\");\r\n        xmlmc.addParam(\"parameters\", sqparams);\r\n        xmlmc.invoke(\"data\", \"invokeStoredQuery\", {\r\n          onSuccess: function(params){\r\n\t\t\tif (!angular.isDefined(params.rowData))\r\n\t\t\t{\r\n\t\t\t\tdeferred.resolve(false);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif( Object.prototype.toString.call( params.rowData.row ) === '[object Array]' )\r\n\t\t\t\t{\r\n\t\t\t\t\tvar rowArray = params.rowData.row;\r\n\t\t\t\t\tself.requestAuthorisation = params.rowData.row[0];\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tvar row = params.rowData.row;\r\n\t\t\t\t\tself.requestAuthorisation = params.rowData.row;\r\n\t\t\t\t}\r\n\t\t\t\tif(angular.isDefined(self.requestAuthorisation.managerid))\r\n\t\t\t\t{\r\n\t\t\t\t\tself.custDetails.fk_manager = self.requestAuthorisation.managerid;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tself.custDetails.fk_manager = \"\";\r\n\t\t\t\t}\r\n\t\t\t\tdeferred.resolve(self.requestAuthorisation);\r\n\t\t\t}\r\n\t\t\t  \r\n\t\t\t  \r\n\t\t\t  \r\n            /*if(params.rowData.row.counter === \"1\"){\r\n              self.requestAuthorisation = params.rowData.row;\r\n              if(params.rowData.row.managerid){\r\n                self.custDetails.fk_manager = params.rowData.row.managerid;\r\n              }\r\n              deferred.resolve(self.requestAuthorisation);\r\n            } else {\r\n              deferred.resolve(false);\r\n            }*/\r\n          },\r\n          onFailure: function(error){\r\n            wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::isRequestAuth\", false, false);\r\n            deferred.reject(error);\r\n          }\r\n        });\r\n        return deferred.promise;\r\n      };\r\n\r\n      self.getRequestAuthComponents = function(){\r\n        self.authStandardComponents = [];\r\n        self.authOptionalComponents = [];\r\n        self.authUpgradeComponents = [];\r\n        self.authComponentStrings = [];\r\n        var deferred = $q.defer();\r\n        if(!angular.isDefined(self.requestDetails.itsm_fk_service) || self.requestDetails.itsm_fk_service === ''){\r\n          deferred.resolve(self.authComponentStrings);\r\n        } else {\r\n          var sqparams = \"callref=\"+self.callref;\r\n          sqparams += \"&sid=\"+self.requestDetails.itsm_fk_service;\r\n          var xmlmc = new XMLMCService.MethodCall();\r\n          xmlmc.addParam(\"storedQuery\", \"query/wss/authorisations/request.auth.components\");\r\n          xmlmc.addParam(\"parameters\", sqparams);\r\n          xmlmc.invoke(\"data\", \"invokeStoredQuery\", {\r\n            onSuccess: function(compResponse){\r\n              if(compResponse.rowData) {\r\n                if( Object.prototype.toString.call( compResponse.rowData.row ) === '[object Array]' ) {\r\n                  var intArrayLength = compResponse.rowData.row.length;\r\n                  //obj is array\r\n                  for (var i = 0; i < intArrayLength; i++) {\r\n                    if(compResponse.rowData.row[i].flg_isoptional === \"0\"){\r\n                      self.authOptionalComponents.push(compResponse.rowData.row[i]);\r\n                    } else {\r\n                      self.authStandardComponents.push(compResponse.rowData.row[i]);\r\n                    }\r\n                  }\r\n                } else {\r\n                  if(compResponse.rowData.row.flg_isoptional === \"0\"){\r\n                    self.authOptionalComponents.push(compResponse.rowData.row);\r\n                  } else {\r\n                    self.authStandardComponents.push(compResponse.rowData.row);\r\n                  }\r\n                }\r\n                //Now get upgraded components\r\n                var sqparams = \"callref=\"+self.callref;\r\n                sqparams += \"&sid=\"+self.requestDetails.itsm_fk_service;\r\n                var xmlmc = new XMLMCService.MethodCall();\r\n                xmlmc.addParam(\"storedQuery\", \"query/wss/authorisations/request.auth.components.override\");\r\n                xmlmc.addParam(\"parameters\", sqparams);\r\n                xmlmc.invoke(\"data\", \"invokeStoredQuery\", {\r\n                  onSuccess: function(upgradeCompResponse){\r\n                    if(upgradeCompResponse.rowData) {\r\n                      if( Object.prototype.toString.call( upgradeCompResponse.rowData.row ) === '[object Array]' ) {\r\n                        var intArrayLength = upgradeCompResponse.rowData.row.length;\r\n                        //obj is array\r\n                        for (var i = 0; i < intArrayLength; i++) {\r\n                          self.authUpgradeComponents.push(upgradeCompResponse.rowData.row[i]);\r\n                        }\r\n                      } else {\r\n                        self.authUpgradeComponents.push(upgradeCompResponse.rowData.row);\r\n                      }\r\n                    }\r\n                    //Now build component string list.\r\n                    //Standard Components\r\n                    angular.forEach(self.authStandardComponents, function(aCompVal, aCompKey){\r\n                      self.authComponentStrings.push(aCompVal.qty+\"x '\"+aCompVal.description+\"' is a standard component\");\r\n                    });\r\n                    //Upgraded Components\r\n                    angular.forEach(self.authUpgradeComponents, function(aCompVal, aCompKey){\r\n                      self.authComponentStrings.push(\"Replacing \"+aCompVal.overqty+\"x '\"+aCompVal.override+\"' with \"+aCompVal.qty+\"x '\"+aCompVal.description+\"' at an additional cost of \"+aCompVal.price_diff);\r\n                    });\r\n                    //Optional Components\r\n                    angular.forEach(self.authOptionalComponents, function(aCompVal, aCompKey){\r\n                      self.authComponentStrings.push(aCompVal.qty+\"x '\"+aCompVal.description+\"' is optional at a price of \"+aCompVal.comp_price);\r\n                    });\r\n                    deferred.resolve(self.authComponentStrings);\r\n                  },\r\n                  onFailure: function(error){\r\n                    wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getRequestAuthComponents\", false, false);\r\n                    //Now build component string list.\r\n                    //Standard Components\r\n                    angular.forEach(self.authStandardComponents, function(aCompVal, aCompKey){\r\n                      self.authComponentStrings.push(aCompVal.qty+\"x '\"+aCompVal.description+\"' is a standard component\");\r\n                    });\r\n                    //Optional Components\r\n                    angular.forEach(self.authOptionalComponents, function(aCompVal, aCompKey){\r\n                      self.authComponentStrings.push(aCompVal.qty+\"x '\"+aCompVal.description+\"' is optional at a price of \"+aCompVal.comp_price);\r\n                    });\r\n                    deferred.resolve(self.authComponentStrings);\r\n                  }\r\n                });\r\n\r\n              } else {\r\n                deferred.resolve({});\r\n              }\r\n            },\r\n            onFailure: function(error){\r\n              wssLogging.logger(error, \"ERROR\", \"RequestDetailsService::getRequestAuthComponents\", false, false);\r\n              deferred.reject(error);\r\n            }\r\n          });\r\n        }\r\n        return deferred.promise;\r\n      };\r\n\r\n      self.getFileIcon = function(fileName) {\r\n        var fileExtension = fileName.slice((fileName.lastIndexOf(\".\") - 1 >>> 0) + 2);\r\n        switch(fileExtension) {\r\n          case \"txt\":\r\n          return \"fa-file-text-o\";\r\n          case \"png\":\r\n          case \"jpg\":\r\n          case \"jpeg\":\r\n          case \"gif\":\r\n          case \"tif\":\r\n          case \"tiff\":\r\n          case \"bpm\":\r\n          return \"fa-file-image-o\";\r\n          case \"htm\":\r\n          case \"html\":\r\n          case \"mht\":\r\n          case \"xml\":\r\n          return \"fa-file-code-o\";\r\n          case \"doc\":\r\n          case \"docx\":\r\n          case \"docm\":\r\n          return \"fa-file-word-o\";\r\n          case \"xls\":\r\n          case \"xlsx\":\r\n          case \"xlsm\":\r\n          return \"fa-file-excel-o\";\r\n          case \"pdf\":\r\n          return \"fa-file-pdf-o\";\r\n          case \"ppt\":\r\n          case \"pptx\":\r\n          return \"fa-file-powerpoint-o\";\r\n          case \"mp3\":\r\n          case \"wav\":\r\n          case \"wma\":\r\n          return \"fa-file-audio-o\";\r\n          case \"zip\":\r\n          case \"gz\":\r\n          case \"gzi\":\r\n          case \"gzip\":\r\n          case \"rar\":\r\n          case \"7zip\":\r\n          case \"7z\":\r\n          return \"fa-file-archive-o\";\r\n          default:\r\n          return \"fa-file-o\";\r\n        }\r\n      };\r\n\r\n      return self;\r\n    }\r\n\r\n})();\r\n"]}